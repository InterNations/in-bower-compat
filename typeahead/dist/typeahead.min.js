var VERSION="0.9.3",utils={isMsie:function(){var a=/(msie) ([\w.]+)/i.exec(navigator.userAgent);return a?parseInt(a[2],10):!1},isBlankString:function(a){return!a||/^\s*$/.test(a)},escapeRegExChars:function(a){return a.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},isString:function(a){return"string"==typeof a},isNumber:function(a){return"number"==typeof a},isArray:$.isArray,isFunction:$.isFunction,isObject:$.isPlainObject,isUndefined:function(a){return"undefined"==typeof a},bind:$.proxy,bindAll:function(a){var b;for(var c in a)$.isFunction(b=a[c])&&(a[c]=$.proxy(b,a))},indexOf:function(a,b){for(var c=0;c<a.length;c++)if(a[c]===b)return c;return-1},each:$.each,map:$.map,filter:$.grep,every:function(a,b){var c=!0;return a?($.each(a,function(d,e){return(c=b.call(null,e,d,a))?void 0:!1}),!!c):c},some:function(a,b){var c=!1;return a?($.each(a,function(d,e){return(c=b.call(null,e,d,a))?!1:void 0}),!!c):c},mixin:$.extend,getUniqueId:function(){var a=0;return function(){return a++}}(),defer:function(a){setTimeout(a,0)},debounce:function(a,b,c){var d,e;return function(){var f,g,h=this,i=arguments;return f=function(){d=null,c||(e=a.apply(h,i))},g=c&&!d,clearTimeout(d),d=setTimeout(f,b),g&&(e=a.apply(h,i)),e}},throttle:function(a,b){var c,d,e,f,g,h;return g=0,h=function(){g=new Date,e=null,f=a.apply(c,d)},function(){var i=new Date,j=b-(i-g);return c=this,d=arguments,0>=j?(clearTimeout(e),e=null,g=i,f=a.apply(c,d)):e||(e=setTimeout(h,j)),f}},tokenizeQuery:function(a){return $.trim(a).toLowerCase().split(/[\s]+/)},tokenizeText:function(a){return $.trim(a).toLowerCase().split(/[\s\-_]+/)},getProtocol:function(){return location.protocol},noop:function(){}},EventTarget=function(){var a=/\s+/;return{on:function(b,c){var d;if(!c)return this;for(this._callbacks=this._callbacks||{},b=b.split(a);d=b.shift();)this._callbacks[d]=this._callbacks[d]||[],this._callbacks[d].push(c);return this},trigger:function(b,c){var d,e;if(!this._callbacks)return this;for(b=b.split(a);d=b.shift();)if(e=this._callbacks[d])for(var f=0;f<e.length;f+=1)e[f].call(this,{type:d,data:c});return this}}}(),EventBus=function(){function a(a){a&&a.el||$.error("EventBus initialized without el"),this.$el=$(a.el)}var b="typeahead:";return utils.mixin(a.prototype,{trigger:function(a){var c=[].slice.call(arguments,1);this.$el.trigger(b+a,c)}}),a}(),PersistentStorage=function(){function a(a){this.prefix=["__",a,"__"].join(""),this.ttlKey="__ttl__",this.keyMatcher=new RegExp("^"+this.prefix)}function b(){return(new Date).getTime()}function c(a){return JSON.stringify(utils.isUndefined(a)?null:a)}function d(a){return JSON.parse(a)}var e,f;try{e=window.localStorage,e.setItem("~~~","!"),e.removeItem("~~~")}catch(g){e=null}return f=e&&window.JSON?{_prefix:function(a){return this.prefix+a},_ttlKey:function(a){return this._prefix(a)+this.ttlKey},get:function(a){return this.isExpired(a)&&this.remove(a),d(e.getItem(this._prefix(a)))},set:function(a,d,f){return utils.isNumber(f)?e.setItem(this._ttlKey(a),c(b()+f)):e.removeItem(this._ttlKey(a)),e.setItem(this._prefix(a),c(d))},remove:function(a){return e.removeItem(this._ttlKey(a)),e.removeItem(this._prefix(a)),this},clear:function(){var a,b,c=[],d=e.length;for(a=0;d>a;a++)(b=e.key(a)).match(this.keyMatcher)&&c.push(b.replace(this.keyMatcher,""));for(a=c.length;a--;)this.remove(c[a]);return this},isExpired:function(a){var c=d(e.getItem(this._ttlKey(a)));return utils.isNumber(c)&&b()>c?!0:!1}}:{get:utils.noop,set:utils.noop,remove:utils.noop,clear:utils.noop,isExpired:utils.noop},utils.mixin(a.prototype,f),a}(),RequestCache=function(){function a(a){utils.bindAll(this),a=a||{},this.sizeLimit=a.sizeLimit||10,this.cache={},this.cachedKeysByAge=[]}return utils.mixin(a.prototype,{get:function(a){return this.cache[a]},set:function(a,b){var c;this.cachedKeysByAge.length===this.sizeLimit&&(c=this.cachedKeysByAge.shift(),delete this.cache[c]),this.cache[a]=b,this.cachedKeysByAge.push(a)}}),a}(),Transport=function(){function a(a){utils.bindAll(this),a=utils.isString(a)?{url:a}:a,f=f||new RequestCache,e=utils.isNumber(a.maxParallelRequests)?a.maxParallelRequests:e||6,this.url=a.url,this.wildcard=a.wildcard||"%QUERY",this.filter=a.filter,this.replace=a.replace,this.ajaxSettings={type:"get",cache:a.cache,timeout:a.timeout,dataType:a.dataType||"json",beforeSend:a.beforeSend,complete:a.complete},this._get=(/^throttle$/i.test(a.rateLimitFn)?utils.throttle:utils.debounce)(this._get,a.rateLimitWait||300),this.$ajax=a.$ajax||$.ajax}function b(){g++}function c(){g--}function d(){return e>g}var e,f,g=0,h={};return utils.mixin(a.prototype,{_get:function(a,b){function c(c){var d=e.filter?e.filter(c):c;b&&b(d),f.set(a,c)}var e=this;d()?this._sendRequest(a).done(c):this.onDeckRequestArgs=[].slice.call(arguments,0)},_sendRequest:function(a){function d(){c(),h[a]=null,e.onDeckRequestArgs&&(e._get.apply(e,e.onDeckRequestArgs),e.onDeckRequestArgs=null)}var e=this,f=h[a];return f||(b(),f=h[a]=$.ajax(a,this.ajaxSettings).always(d)),f},get:function(a,b){var c,d,e=this,g=encodeURIComponent(a||"");return b=b||utils.noop,c=this.replace?this.replace(this.url,g):this.url.replace(this.wildcard,g),(d=f.get(c))?utils.defer(function(){b(e.filter?e.filter(d):d)}):this._get(c,b),!!d}}),a}(),Dataset=function(){function a(a){utils.bindAll(this),utils.isString(a.template)&&!a.engine&&$.error("no template engine specified"),a.local||a.prefetch||a.remote||$.error("one of local, prefetch, or remote is required"),this.name=a.name||utils.getUniqueId(),this.limit=a.limit||5,this.minLength=a.minLength||1,this.header=a.header,this.footer=a.footer,this.valueKey=a.valueKey||"value",this.template=b(a.template,a.engine,this.valueKey),this.local=a.local,this.prefetch=a.prefetch,this.remote=a.remote,this.itemHash={},this.adjacencyList={},this.storage=a.name?new PersistentStorage(a.name):null}function b(a,b,c){var d,e;return utils.isFunction(a)?d=a:utils.isString(a)?(e=b.compile(a),d=utils.bind(e.render,e)):d=function(a){return"<p>"+a[c]+"</p>"},d}var c={thumbprint:"thumbprint",protocol:"protocol",itemHash:"itemHash",adjacencyList:"adjacencyList"};return utils.mixin(a.prototype,{_processLocalData:function(a){this._mergeProcessedData(this._processData(a))},_loadPrefetchData:function(a){function b(b){var d=a.filter?a.filter(b):b,e=j._processData(d),f=e.itemHash,g=e.adjacencyList;j.storage&&(j.storage.set(c.itemHash,f,a.ttl),j.storage.set(c.adjacencyList,g,a.ttl),j.storage.set(c.thumbprint,k,a.ttl),j.storage.set(c.protocol,utils.getProtocol(),a.ttl)),j._mergeProcessedData(e)}var d,e,f,g,h,i,j=this,k=VERSION+(a.thumbprint||"");return this.storage&&(d=this.storage.get(c.thumbprint),e=this.storage.get(c.protocol),f=this.storage.get(c.itemHash),g=this.storage.get(c.adjacencyList)),h=d!==k||e!==utils.getProtocol(),a=utils.isString(a)?{url:a}:a,a.ttl=utils.isNumber(a.ttl)?a.ttl:864e5,f&&g&&!h?(this._mergeProcessedData({itemHash:f,adjacencyList:g}),i=$.Deferred().resolve()):i=$.getJSON(a.url).done(b),i},_transformDatum:function(a){var b=utils.isString(a)?a:a[this.valueKey],c=a.tokens||utils.tokenizeText(b),d={value:b,tokens:c};return utils.isString(a)?(d.datum={},d.datum[this.valueKey]=a):d.datum=a,d.tokens=utils.filter(d.tokens,function(a){return!utils.isBlankString(a)}),d.tokens=utils.map(d.tokens,function(a){return a.toLowerCase()}),d},_processData:function(a){var b=this,c={},d={};return utils.each(a,function(a,e){var f=b._transformDatum(e),g=utils.getUniqueId(f.value);c[g]=f,utils.each(f.tokens,function(a,b){var c=b.charAt(0),e=d[c]||(d[c]=[g]);!~utils.indexOf(e,g)&&e.push(g)})}),{itemHash:c,adjacencyList:d}},_mergeProcessedData:function(a){var b=this;utils.mixin(this.itemHash,a.itemHash),utils.each(a.adjacencyList,function(a,c){var d=b.adjacencyList[a];b.adjacencyList[a]=d?d.concat(c):c})},_getLocalSuggestions:function(a){var b,c=this,d=[],e=[],f=[];return utils.each(a,function(a,b){var c=b.charAt(0);!~utils.indexOf(d,c)&&d.push(c)}),utils.each(d,function(a,d){var f=c.adjacencyList[d];return f?(e.push(f),(!b||f.length<b.length)&&(b=f),void 0):!1}),e.length<d.length?[]:(utils.each(b,function(b,d){var g,h,i=c.itemHash[d];g=utils.every(e,function(a){return~utils.indexOf(a,d)}),h=g&&utils.every(a,function(a){return utils.some(i.tokens,function(b){return 0===b.indexOf(a)})}),h&&f.push(i)}),f)},initialize:function(){var a;return this.local&&this._processLocalData(this.local),this.transport=this.remote?new Transport(this.remote):null,a=this.prefetch?this._loadPrefetchData(this.prefetch):$.Deferred().resolve(),this.local=this.prefetch=this.remote=null,this.initialize=function(){return a},a},getSuggestions:function(a,b){function c(a){e=e.slice(0),utils.each(a,function(a,b){var c,d=f._transformDatum(b);return c=utils.some(e,function(a){return d.value===a.value}),!c&&e.push(d),e.length<f.limit}),b&&b(e)}var d,e,f=this,g=!1;a.length<this.minLength||(d=utils.tokenizeQuery(a),e=this._getLocalSuggestions(d).slice(0,this.limit),e.length<this.limit&&this.transport&&(g=this.transport.get(a,c)),(e.length||!this.transport)&&!g&&b&&b(e))}}),a}(),InputView=function(){function a(a){var c=this;utils.bindAll(this),this.specialKeyCodeMap={9:"tab",27:"esc",37:"left",39:"right",13:"enter",38:"up",40:"down"},this.$hint=$(a.hint),this.$input=$(a.input).on("blur.tt",this._handleBlur).on("focus.tt",this._handleFocus).on("keydown.tt",this._handleSpecialKeyEvent),utils.isMsie()?this.$input.on("keydown.tt keypress.tt cut.tt paste.tt",function(a){c.specialKeyCodeMap[a.which||a.keyCode]||utils.defer(c._compareQueryToInputValue)}):this.$input.on("input.tt",this._compareQueryToInputValue),this.query=this.$input.val(),this.$overflowHelper=b(this.$input)}function b(a){return $("<span></span>").css({position:"absolute",left:"-9999px",visibility:"hidden",whiteSpace:"nowrap",fontFamily:a.css("font-family"),fontSize:a.css("font-size"),fontStyle:a.css("font-style"),fontVariant:a.css("font-variant"),fontWeight:a.css("font-weight"),wordSpacing:a.css("word-spacing"),letterSpacing:a.css("letter-spacing"),textIndent:a.css("text-indent"),textRendering:a.css("text-rendering"),textTransform:a.css("text-transform")}).insertAfter(a)}function c(a,b){return a=(a||"").replace(/^\s*/g,"").replace(/\s{2,}/g," "),b=(b||"").replace(/^\s*/g,"").replace(/\s{2,}/g," "),a===b}return utils.mixin(a.prototype,EventTarget,{_handleFocus:function(){this.trigger("focused")},_handleBlur:function(){this.trigger("blured")},_handleSpecialKeyEvent:function(a){var b=this.specialKeyCodeMap[a.which||a.keyCode];b&&this.trigger(b+"Keyed",a)},_compareQueryToInputValue:function(){var a=this.getInputValue(),b=c(this.query,a),d=b?this.query.length!==a.length:!1;d?this.trigger("whitespaceChanged",{value:this.query}):b||this.trigger("queryChanged",{value:this.query=a})},destroy:function(){this.$hint.off(".tt"),this.$input.off(".tt"),this.$hint=this.$input=this.$overflowHelper=null},focus:function(){this.$input.focus()},blur:function(){this.$input.blur()},getQuery:function(){return this.query},setQuery:function(a){this.query=a},getInputValue:function(){return this.$input.val()},setInputValue:function(a,b){this.$input.val(a),!b&&this._compareQueryToInputValue()},getHintValue:function(){return this.$hint.val()},setHintValue:function(a){this.$hint.val(a)},getLanguageDirection:function(){return(this.$input.css("direction")||"ltr").toLowerCase()},isOverflow:function(){return this.$overflowHelper.text(this.getInputValue()),this.$overflowHelper.width()>this.$input.width()},isCursorAtEnd:function(){var a,b=this.$input.val().length,c=this.$input[0].selectionStart;return utils.isNumber(c)?c===b:document.selection?(a=document.selection.createRange(),a.moveStart("character",-b),b===a.text.length):!0}}),a}(),DropdownView=function(){function a(a){utils.bindAll(this),this.isOpen=!1,this.isEmpty=!0,this.isMouseOverDropdown=!1,this.$menu=$(a.menu).on("mouseenter.tt",this._handleMouseenter).on("mouseleave.tt",this._handleMouseleave).on("click.tt",".tt-suggestion",this._handleSelection).on("mouseover.tt",".tt-suggestion",this._handleMouseover)}function b(a){return a.data("suggestion")}var c={suggestionsList:'<span class="tt-suggestions"></span>'},d={suggestionsList:{display:"block"},suggestion:{whiteSpace:"nowrap",cursor:"pointer"},suggestionChild:{whiteSpace:"normal"}};return utils.mixin(a.prototype,EventTarget,{_handleMouseenter:function(){this.isMouseOverDropdown=!0},_handleMouseleave:function(){this.isMouseOverDropdown=!1},_handleMouseover:function(a){var b=$(a.currentTarget);this._getSuggestions().removeClass("tt-is-under-cursor"),b.addClass("tt-is-under-cursor")},_handleSelection:function(a){var c=$(a.currentTarget);this.trigger("suggestionSelected",b(c))},_show:function(){this.$menu.css("display","block")},_hide:function(){this.$menu.hide()},_moveCursor:function(a){var c,d,e,f;if(this.isVisible()){if(c=this._getSuggestions(),d=c.filter(".tt-is-under-cursor"),d.removeClass("tt-is-under-cursor"),e=c.index(d)+a,e=(e+1)%(c.length+1)-1,-1===e)return this.trigger("cursorRemoved"),void 0;-1>e&&(e=c.length-1),f=c.eq(e).addClass("tt-is-under-cursor"),this._ensureVisibility(f),this.trigger("cursorMoved",b(f))}},_getSuggestions:function(){return this.$menu.find(".tt-suggestions > .tt-suggestion")},_ensureVisibility:function(a){var b=this.$menu.height()+parseInt(this.$menu.css("paddingTop"),10)+parseInt(this.$menu.css("paddingBottom"),10),c=this.$menu.scrollTop(),d=a.position().top,e=d+a.outerHeight(!0);0>d?this.$menu.scrollTop(c+d):e>b&&this.$menu.scrollTop(c+(e-b))},destroy:function(){this.$menu.off(".tt"),this.$menu=null},isVisible:function(){return this.isOpen&&!this.isEmpty},closeUnlessMouseIsOverDropdown:function(){this.isMouseOverDropdown||this.close()},close:function(){this.isOpen&&(this.isOpen=!1,this.isMouseOverDropdown=!1,this._hide(),this.$menu.find(".tt-suggestions > .tt-suggestion").removeClass("tt-is-under-cursor"),this.trigger("closed"))},open:function(){this.isOpen||(this.isOpen=!0,!this.isEmpty&&this._show(),this.trigger("opened"))},setLanguageDirection:function(a){var b={left:"0",right:"auto"},c={left:"auto",right:" 0"};"ltr"===a?this.$menu.css(b):this.$menu.css(c)},moveCursorUp:function(){this._moveCursor(-1)},moveCursorDown:function(){this._moveCursor(1)},getSuggestionUnderCursor:function(){var a=this._getSuggestions().filter(".tt-is-under-cursor").first();return a.length>0?b(a):null},getFirstSuggestion:function(){var a=this._getSuggestions().first();return a.length>0?b(a):null},renderSuggestions:function(a,b){var e,f,g,h,i,j="tt-dataset-"+a.name,k='<div class="tt-suggestion">%body</div>',l=this.$menu.find("."+j);0===l.length&&(f=$(c.suggestionsList).css(d.suggestionsList),l=$("<div></div>").addClass(j).append(a.header).append(f).append(a.footer).appendTo(this.$menu)),b.length>0?(this.isEmpty=!1,this.isOpen&&this._show(),g=document.createElement("div"),h=document.createDocumentFragment(),utils.each(b,function(b,c){c.dataset=a.name,e=a.template(c.datum),g.innerHTML=k.replace("%body",e),i=$(g.firstChild).css(d.suggestion).data("suggestion",c),i.children().each(function(){$(this).css(d.suggestionChild)}),h.appendChild(i[0])}),l.show().find(".tt-suggestions").html(h)):this.clearSuggestions(a.name),this.trigger("suggestionsRendered")},clearSuggestions:function(a){var b=a?this.$menu.find(".tt-dataset-"+a):this.$menu.find('[class^="tt-dataset-"]'),c=b.find(".tt-suggestions");b.hide(),c.empty(),0===this._getSuggestions().length&&(this.isEmpty=!0,this._hide())}}),a}(),TypeaheadView=function(){function a(a){var c,d,e;utils.bindAll(this),this.$node=b(a.input),this.datasets=a.datasets,this.dir=null,this.eventBus=a.eventBus,c=this.$node.find(".tt-dropdown-menu"),d=this.$node.find(".tt-query"),e=this.$node.find(".tt-hint"),this.dropdownView=new DropdownView({menu:c}).on("suggestionSelected",this._handleSelection).on("cursorMoved",this._clearHint).on("cursorMoved",this._setInputValueToSuggestionUnderCursor).on("cursorRemoved",this._setInputValueToQuery).on("cursorRemoved",this._updateHint).on("suggestionsRendered",this._updateHint).on("opened",this._updateHint).on("closed",this._clearHint).on("opened closed",this._propagateEvent),this.inputView=new InputView({input:d,hint:e}).on("focused",this._openDropdown).on("blured",this._closeDropdown).on("blured",this._setInputValueToQuery).on("enterKeyed tabKeyed",this._handleSelection).on("queryChanged",this._clearHint).on("queryChanged",this._getSuggestions).on("whitespaceChanged",this._updateHint).on("queryChanged whitespaceChanged",this._openDropdown).on("queryChanged whitespaceChanged",this._setLanguageDirection).on("escKeyed",this._closeDropdown).on("escKeyed",this._setInputValueToQuery).on("tabKeyed upKeyed downKeyed",this._managePreventDefault).on("upKeyed downKeyed",this._moveDropdownCursor).on("upKeyed downKeyed",this._openDropdown).on("tabKeyed leftKeyed rightKeyed",this._autocomplete)}function b(a){var b=$(d.wrapper),c=$(d.dropdown),f=$(a),g=$(d.hint);b=b.css(e.wrapper),c=c.css(e.dropdown),g.css(e.hint).css({backgroundAttachment:f.css("background-attachment"),backgroundClip:f.css("background-clip"),backgroundColor:f.css("background-color"),backgroundImage:f.css("background-image"),backgroundOrigin:f.css("background-origin"),backgroundPosition:f.css("background-position"),backgroundRepeat:f.css("background-repeat"),backgroundSize:f.css("background-size")}),f.data("ttAttrs",{dir:f.attr("dir"),autocomplete:f.attr("autocomplete"),spellcheck:f.attr("spellcheck"),style:f.attr("style")}),f.addClass("tt-query").attr({autocomplete:"off",spellcheck:!1}).css(e.query);try{!f.attr("dir")&&f.attr("dir","auto")}catch(h){}return f.wrap(b).parent().prepend(g).append(c)}function c(a){var b=a.find(".tt-query");utils.each(b.data("ttAttrs"),function(a,c){utils.isUndefined(c)?b.removeAttr(a):b.attr(a,c)}),b.detach().removeData("ttAttrs").removeClass("tt-query").insertAfter(a),a.remove()}var d={wrapper:'<span class="twitter-typeahead"></span>',hint:'<input class="tt-hint" type="text" autocomplete="off" spellcheck="off" disabled>',dropdown:'<span class="tt-dropdown-menu"></span>'},e={wrapper:{position:"relative",display:"inline-block"},hint:{position:"absolute",top:"0",left:"0",borderColor:"transparent",boxShadow:"none"},query:{position:"relative",verticalAlign:"top",backgroundColor:"transparent"},dropdown:{position:"absolute",top:"100%",left:"0",zIndex:"100",display:"none"}};return utils.isMsie()&&utils.mixin(e.query,{backgroundImage:"url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7)"}),utils.isMsie()&&utils.isMsie()<=7&&(utils.mixin(e.wrapper,{display:"inline",zoom:"1"}),utils.mixin(e.query,{marginTop:"-1px"})),utils.mixin(a.prototype,EventTarget,{_managePreventDefault:function(a){var b,c,d=a.data,e=!1;switch(a.type){case"tabKeyed":b=this.inputView.getHintValue(),c=this.inputView.getInputValue(),e=b&&b!==c;break;case"upKeyed":case"downKeyed":e=!d.shiftKey&&!d.ctrlKey&&!d.metaKey}e&&d.preventDefault()},_setLanguageDirection:function(){var a=this.inputView.getLanguageDirection();a!==this.dir&&(this.dir=a,this.$node.css("direction",a),this.dropdownView.setLanguageDirection(a))},_updateHint:function(){var a,b,c,d,e,f=this.dropdownView.getFirstSuggestion(),g=f?f.value:null,h=this.dropdownView.isVisible(),i=this.inputView.isOverflow();g&&h&&!i&&(a=this.inputView.getInputValue(),b=a.replace(/\s{2,}/g," ").replace(/^\s+/g,""),c=utils.escapeRegExChars(b),d=new RegExp("^(?:"+c+")(.*$)","i"),e=d.exec(g),this.inputView.setHintValue(a+(e?e[1]:"")))},_clearHint:function(){this.inputView.setHintValue("")},_clearSuggestions:function(){this.dropdownView.clearSuggestions()},_setInputValueToQuery:function(){var a=this.inputView.getQuery();""!==a&&this.inputView.setInputValue(a)},_setInputValueToSuggestionUnderCursor:function(a){var b=a.data;this.inputView.setInputValue(b.value,!0)},_openDropdown:function(){this.dropdownView.open()},_closeDropdown:function(a){this.dropdownView["blured"===a.type?"closeUnlessMouseIsOverDropdown":"close"]()},_moveDropdownCursor:function(a){var b=a.data;b.shiftKey||b.ctrlKey||b.metaKey||this.dropdownView["upKeyed"===a.type?"moveCursorUp":"moveCursorDown"]()},_handleSelection:function(a){var b="suggestionSelected"===a.type,c=b?a.data:this.dropdownView.getSuggestionUnderCursor();c&&(this.inputView.setInputValue(c.value),b?this.inputView.focus():a.data.preventDefault(),b&&utils.isMsie()?utils.defer(this.dropdownView.close):this.dropdownView.close(),this.eventBus.trigger("selected",c.datum,c.dataset))},_getSuggestions:function(){var a=this,b=this.inputView.getQuery();return utils.isBlankString(b)?(this._clearSuggestions(),void 0):(utils.each(this.datasets,function(c,d){d.getSuggestions(b,function(c){b===a.inputView.getQuery()&&a.dropdownView.renderSuggestions(d,c)})}),void 0)},_autocomplete:function(a){var b,c,d,e,f;("rightKeyed"!==a.type&&"leftKeyed"!==a.type||(b=this.inputView.isCursorAtEnd(),c="ltr"===this.inputView.getLanguageDirection()?"leftKeyed"===a.type:"rightKeyed"===a.type,b&&!c))&&(d=this.inputView.getQuery(),e=this.inputView.getHintValue(),""!==e&&d!==e&&(f=this.dropdownView.getFirstSuggestion(),this.inputView.setInputValue(f.value),this.eventBus.trigger("autocompleted",f.datum,f.dataset)))},_propagateEvent:function(a){this.eventBus.trigger(a.type)},destroy:function(){this.inputView.destroy(),this.dropdownView.destroy(),c(this.$node),this.$node=null},setQuery:function(a){this.inputView.setQuery(a),this.inputView.setInputValue(a),this._clearHint(),this._clearSuggestions(),this._getSuggestions()}}),a}();!function(){var a,b={},c="ttView";a={initialize:function(a){function d(){var a,b=$(this),d=new EventBus({el:b});a=utils.map(e,function(a){return a.initialize()}),b.data(c,new TypeaheadView({input:b,eventBus:d=new EventBus({el:b}),datasets:e})),$.when.apply($,a).always(function(){utils.defer(function(){d.trigger("initialized")})})}var e;return a=utils.isArray(a)?a:[a],0===a.length&&$.error("no datasets provided"),e=utils.map(a,function(a){var c=b[a.name]?b[a.name]:new Dataset(a);return a.name&&(b[a.name]=c),c}),this.each(d)},destroy:function(){function a(){var a=$(this),b=a.data(c);b&&(b.destroy(),a.removeData(c))}return this.each(a)},setQuery:function(a){function b(){var b=$(this).data(c);b&&b.setQuery(a)}return this.each(b)}},jQuery.fn.typeahead=function(b){return a[b]?a[b].apply(this,[].slice.call(arguments,1)):a.initialize.apply(this,arguments)}}();